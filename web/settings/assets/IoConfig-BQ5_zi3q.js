const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/io_device-ARyi7Xca.js","assets/index-qJlpzmNq.js","assets/vendor-Bf6WG9RU.js","assets/vendor-sortablejs-BP6ZwAeQ.js","assets/vendor-D1GV4U4l.css","assets/vendor-fortawesome-B5dv1i-o.js","assets/vendor-bootstrap-jR5PzzKy.js","assets/vendor-jquery-CEMonh9Y.js","assets/vendor-bootstrap-BJ8HpIhY.css","assets/vendor-axios-DEB3Nr0m.js","assets/index-Dz52rCQA.css","assets/dynamic-import-helper-BheWnx7M.js","assets/io_device-B30dbKuT.js","assets/io_device-DyNzlCtX.js","assets/io_action-DJIG6e1Q.js","assets/OpenwbIoSinglePattern-BkM1I0t3.js","assets/io_action-BWQ_rAVx.js","assets/io_action-D3tPaQ7m.js","assets/OpenwbIoPattern-I3jpP1bj.js","assets/OpenwbIoPattern-01UVkHjE.css","assets/io_action-BddU9Q3G.js"])))=>i.map(i=>d[i]);
import{F as S,l as $,ab as L}from"./vendor-fortawesome-B5dv1i-o.js";import{_ as D,C as W}from"./index-qJlpzmNq.js";import{_ as j}from"./dynamic-import-helper-BheWnx7M.js";import{_ as I,m as d,l as n,f as c,q as g,D as i,z as r,K as b,E as s,y as _,a1 as M,L as C,M as B,x as h,a2 as T}from"./vendor-Bf6WG9RU.js";const U={props:{ioDevice:{type:Object,required:!0}},emits:["update:configuration","sendCommand"],methods:{updateConfiguration(t,e=void 0){this.$emit("update:configuration",{value:t,object:e})},sendSystemCommand(t,e){this.$emit("sendCommand",{command:t,data:e})}}},F=I(U,[["__file","/opt/openWB-dev/openwb-ui-settings/src/components/io_devices/OpenwbIoDeviceConfigMixin.vue"]]),N={name:"OpenwbIoDeviceConfigFallback",mixins:[F]},R={class:"io-device-config-fallback"},z={key:1};function G(t,e,l,A,u,o){const p=d("openwb-base-alert"),y=d("openwb-base-textarea");return n(),c("div",R,[Object.keys(t.ioDevice.configuration).length==0?(n(),g(p,{key:0,subtype:"info"},{default:i(()=>[r(' Das I/O-Modul "'+b(t.ioDevice.name)+'" bietet keine Einstellungen. ',1)]),_:1})):(n(),c("div",z,[s(p,{subtype:"warning"},{default:i(()=>[r(' Es wurde keine Konfigurationsseite für das I/O-Modul "'+b(t.ioDevice.name)+'" gefunden. Die Einstellungen können als JSON direkt bearbeitet werden. ',1)]),_:1}),s(y,{title:"Konfiguration",subtype:"json","model-value":t.ioDevice.configuration,"onUpdate:modelValue":e[0]||(e[0]=f=>t.updateConfiguration(f,"configuration"))},{help:i(()=>[...e[1]||(e[1]=[r(" Bitte prüfe, ob die Eingaben richtig interpretiert werden. ",-1)])]),_:1},8,["model-value"]),s(p,{subtype:"info"},{default:i(()=>[_("pre",null,b(JSON.stringify(t.ioDevice.configuration,void 0,2)),1)]),_:1})]))])}const J=I(N,[["render",G],["__file","/opt/openWB-dev/openwb-ui-settings/src/components/io_devices/OpenwbIoDeviceConfigFallback.vue"]]),H={name:"OpenwbIoDeviceProxy",props:{ioDevice:{type:Object,required:!0}},emits:["update:configuration","sendCommand"],computed:{myComponent(){return console.debug(`loading io device: ${this.ioDevice.type}`),M({loader:()=>j(Object.assign({"./add_on/io_device.vue":()=>D(()=>import("./io_device-ARyi7Xca.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11])),"./dimm_kit/io_device.vue":()=>D(()=>import("./io_device-B30dbKuT.js"),__vite__mapDeps([12,2,3,4,5,1,6,7,8,9,10,11])),"./eebus/io_device.vue":()=>D(()=>import("./io_device-DyNzlCtX.js"),__vite__mapDeps([13,2,3,4,5,1,6,7,8,9,10,11]))}),`./${this.ioDevice.type}/io_device.vue`,3),errorComponent:J})},outputs(){const t=[];if(this.ioDevice.output){if(this.ioDevice.output.analog)for(const e in this.ioDevice.output.analog)t.push(`openWB/set/system/io/${this.ioDevice.id}/set/manual/analog_output/${e}`);if(this.ioDevice.output.digital)for(const e in this.ioDevice.output.digital)t.push(`openWB/set/system/io/${this.ioDevice.id}/set/manual/digital_output/${e}`)}return t}},methods:{updateConfiguration(t){this.$emit("update:configuration",t)},sendCommand(t){this.$emit("sendCommand",t)}}};function Q(t,e,l,A,u,o){const p=d("openwb-base-heading"),y=d("openwb-base-copy-to-clipboard"),f=d("openwb-base-alert");return n(),c("div",null,[s(p,null,{default:i(()=>[r(' Einstellungen für I/O-Modul "'+b(l.ioDevice.name)+'" ',1)]),_:1}),o.outputs.length?(n(),g(f,{key:0,subtype:"info"},{default:i(()=>[e[2]||(e[2]=r(" Die Ausgänge können über die folgenden Topics manuell per MQTT geschaltet werden. Falls Ausgänge in Aktionen konfiguriert werden, überschreibt das manuelle Setzen den Status. ",-1)),_("ul",null,[(n(!0),c(C,null,B(o.outputs,v=>(n(),c("li",{key:v},[s(y,{class:"text-info",tooltip:"Topic kopieren"},{default:i(()=>[r(b(v),1)]),_:2},1024)]))),128))]),e[3]||(e[3]=r(" Als Wert wird ein boolean als json oder 0/1 akzeptiert.",-1)),e[4]||(e[4]=_("br",null,null,-1)),e[5]||(e[5]=r(" Beispiel: ",-1)),e[6]||(e[6]=_("span",{class:"text-info"},"false",-1))]),_:1})):h("",!0),(n(),g(T(o.myComponent),{"io-device":l.ioDevice,"onUpdate:configuration":e[0]||(e[0]=v=>o.updateConfiguration(v)),onSendCommand:e[1]||(e[1]=v=>o.sendCommand(v))},null,40,["io-device"]))])}const X=I(H,[["render",Q],["__file","/opt/openWB-dev/openwb-ui-settings/src/components/io_devices/OpenwbIoDeviceProxy.vue"]]),Y={mixins:[W],props:{ioAction:{type:Object,required:!0},ioDevice:{type:Object,required:!0},availableChargePoints:{type:Array,required:!1,default:()=>[]},availableComponents:{type:Array,required:!1,default:()=>[]},availableIoDevices:{type:Array,required:!1,default:()=>[]}},emits:["update:configuration","sendCommand"],methods:{updateConfiguration(t,e=void 0){this.$emit("update:configuration",{value:t,object:e})}}},Z=I(Y,[["__file","/opt/openWB-dev/openwb-ui-settings/src/components/io_actions/OpenwbIoActionConfigMixin.vue"]]),K={name:"OpenwbIoActionConfigFallback",mixins:[Z]},ee={class:"io-action-config-fallback"},te={key:1};function oe(t,e,l,A,u,o){const p=d("openwb-base-alert"),y=d("openwb-base-textarea");return n(),c("div",ee,[Object.keys(t.ioAction?.configuration).length==0?(n(),g(p,{key:0,subtype:"info"},{default:i(()=>[r(' Die I/O-Aktion "'+b(t.ioAction?.name)+'" bietet keine Einstellungen. ',1)]),_:1})):(n(),c("div",te,[s(p,{subtype:"warning"},{default:i(()=>[r(' Es wurde keine Konfigurationsseite für die I/O-Aktion "'+b(t.ioAction?.name)+'" gefunden. Die Einstellungen können als JSON direkt bearbeitet werden. ',1)]),_:1}),s(y,{title:"Konfiguration",subtype:"json","model-value":t.ioAction?.configuration,"onUpdate:modelValue":e[0]||(e[0]=f=>t.updateConfiguration(f,"configuration"))},{help:i(()=>[...e[1]||(e[1]=[r(" Bitte prüfe, ob die Eingaben richtig interpretiert werden. ",-1)])]),_:1},8,["model-value"]),s(p,{subtype:"info"},{default:i(()=>[_("pre",null,b(JSON.stringify(t.ioAction?.configuration,void 0,2)),1)]),_:1})]))])}const ne=I(K,[["render",oe],["__file","/opt/openWB-dev/openwb-ui-settings/src/components/io_actions/OpenwbIoActionConfigFallback.vue"]]),ie={name:"OpenwbIoActionProxy",props:{ioAction:{type:Object,required:!0},ioDevices:{type:Object,required:!0},installedChargePoints:{type:Object,required:!0},installedComponents:{type:Object,required:!0}},emits:["update:configuration","sendCommand"],computed:{myComponent(){return console.debug(`loading io action: ${this.ioAction?.group} / ${this.ioAction?.type}`),M({loader:()=>j(Object.assign({"./controllable_consumers/dimming/io_action.vue":()=>D(()=>import("./io_action-DJIG6e1Q.js"),__vite__mapDeps([14,15,2,3,4,5,1,6,7,8,9,10,11])),"./controllable_consumers/dimming_direct_control/io_action.vue":()=>D(()=>import("./io_action-BWQ_rAVx.js"),__vite__mapDeps([16,15,2,3,4,5,1,6,7,8,9,10,11])),"./controllable_consumers/ripple_control_receiver/io_action.vue":()=>D(()=>import("./io_action-D3tPaQ7m.js"),__vite__mapDeps([17,18,5,2,3,4,19,1,6,7,8,9,10,11])),"./generator_systems/stepwise_control/io_action.vue":()=>D(()=>import("./io_action-BddU9Q3G.js"),__vite__mapDeps([20,18,5,2,3,4,19,1,6,7,8,9,10,11]))}),`./${this.ioAction?.group}/${this.ioAction?.type}/io_action.vue`,4),errorComponent:ne})},ioDeviceList(){return Object.keys(this.ioDevices).map(t=>({value:this.ioDevices[t]?.id,text:this.ioDevices[t]?.name}))},availableIoDevices(){return Object.values(this.ioDevices)},availableChargePoints(){return Object.values(this.installedChargePoints).map(t=>({value:t?.id,text:t?.name}))},availableComponents(){return Object.values(this.installedComponents).map(t=>({value:t?.id,text:t?.name,type:t?.type}))}},methods:{updateConfiguration(t,e=void 0){e?this.$emit("update:configuration",{value:t,object:e}):this.$emit("update:configuration",t)},updateIoDevice(t){if(this.updateConfiguration(t,"configuration.io_device"),Array.isArray(this.ioAction.configuration?.input_pattern)){let e=this.ioAction.configuration.input_pattern.map(l=>({value:l.value,matrix:{}}));this.updateConfiguration(e,"configuration.input_pattern")}Object.prototype.hasOwnProperty.call(this.ioAction.configuration,"digital_input")&&this.updateConfiguration(null,"configuration.digital_input")}}},ae={key:0};function se(t,e,l,A,u,o){const p=d("openwb-base-heading"),y=d("openwb-base-select-input");return n(),c(C,null,[s(p,null,{default:i(()=>[r(' Einstellungen für I/O-Aktion "'+b(l.ioAction?.name)+'" ',1)]),_:1}),s(y,{title:"Eingangs-Gerät","not-selected":"Bitte auswählen","empty-value":null,required:"",options:o.ioDeviceList,"model-value":l.ioAction?.configuration.io_device,"onUpdate:modelValue":e[0]||(e[0]=f=>o.updateIoDevice(f))},{help:i(()=>[...e[2]||(e[2]=[r(" Bitte das Gerät auswählen, über das der Schaltbefehl empfangen werden soll. Für jede Aktion kann nur ein Gerät ausgewählt werden. ",-1)])]),_:1},8,["options","model-value"]),l.ioAction?.configuration.io_device!==null?(n(),c("div",ae,[e[3]||(e[3]=_("hr",null,null,-1)),(n(),g(T(o.myComponent),{"io-action":l.ioAction,"io-device":l.ioDevices[`openWB/system/io/${l.ioAction.configuration.io_device}/config`],"available-charge-points":o.availableChargePoints,"available-components":o.availableComponents,"available-io-devices":o.availableIoDevices,"onUpdate:configuration":e[1]||(e[1]=f=>o.updateConfiguration(f))},null,40,["io-action","io-device","available-charge-points","available-components","available-io-devices"]))])):h("",!0)],64)}const re=I(ie,[["render",se],["__file","/opt/openWB-dev/openwb-ui-settings/src/components/io_actions/OpenwbIoActionProxy.vue"]]);$.add(L);const le={name:"OpenwbIoConfigView",components:{FontAwesomeIcon:S,OpenwbIoDeviceProxy:X,OpenwbIoActionProxy:re},mixins:[W],props:{installAssistantActive:{type:Boolean,required:!1,default:!1}},emits:["save","reset","defaults","send-command"],data(){return{mqttTopicsToSubscribe:["openWB/general/extern","openWB/system/configurable/io_devices","openWB/system/io/+/config","openWB/system/configurable/io_actions","openWB/io/action/+/config","openWB/chargepoint/+/config","openWB/system/device/+/component/+/config"],showIoDeviceDeleteModal:!1,modalIoDeviceIndex:void 0,ioDeviceToAdd:void 0,showIoActionDeleteModal:!1,modalIoActionIndex:void 0,ioActionToAdd:void 0}},computed:{ioDeviceList:{get(){let t=this.$store.state.mqtt["openWB/system/configurable/io_devices"];return this.$store.state.mqtt["openWB/general/extern"]===!0?t.filter(e=>e.value=="add_on"):t}},installedIoDevices(){const t=this.getWildcardTopics("openWB/system/io/+/config");return Object.fromEntries(Object.entries(t).filter(([,e])=>e&&typeof e=="object"))},ioActionList:{get(){return this.$store.state.mqtt["openWB/system/configurable/io_actions"]===void 0?[]:Object.entries(this.$store.state.mqtt["openWB/system/configurable/io_actions"]).map(([t,e])=>({label:e.group_name,options:e.actions.map(l=>({value:[t,l.value],text:l.text})).sort((l,A)=>l.text.localeCompare(A.text))})).sort((t,e)=>t.label.localeCompare(e.label))}},installedIoActions:{get(){return this.getWildcardTopics("openWB/io/action/+/config")}},installedChargePoints:{get(){return this.getWildcardTopics("openWB/chargepoint/+/config")}},installedComponents:{get(){return this.getWildcardTopics("openWB/system/device/+/component/+/config")}}},methods:{getIoDeviceName(t){return this.$store.state.mqtt["openWB/system/io/"+t+"/config"]?this.$store.state.mqtt["openWB/system/io/"+t+"/config"].name:"I/O-Gerät "+t},addIoDevice(){this.$emit("send-command",{command:"addIoDevice",data:{type:this.ioDeviceToAdd}})},removeIoDeviceModal(t,e){e.stopPropagation(),this.modalIoDeviceIndex=parseInt(t.match(/(?:\/)(\d+)(?=\/)/)[1]),this.showIoDeviceDeleteModal=!0},removeIoDevice(t,e){this.showIoDeviceDeleteModal=!1,e=="confirm"&&this.$emit("send-command",{command:"removeIoDevice",data:{id:t}})},addIoAction(){this.$emit("send-command",{command:"addIoAction",data:{type:this.ioActionToAdd}})},removeIoActionModal(t,e){e.stopPropagation(),this.modalIoActionIndex=parseInt(t.match(/(?:\/)(\d+)(?=\/)/)[1]),this.showIoActionDeleteModal=!0},removeIoAction(t,e){this.showIoActionDeleteModal=!1,e=="confirm"&&this.$emit("send-command",{command:"removeIoAction",data:{id:t}})},sendSystemCommand(t,e){this.$emit("send-command",{command:t,data:e})},updateConfiguration(t,e){console.debug("updateConfiguration",t,e),this.updateState(t,e.value,e.object)}}},de={class:"ioConfig"},ue={name:"ioConfigForm"},ce={key:0},pe={key:1},me={key:0};function ge(t,e,l,A,u,o){const p=d("openwb-base-modal-dialog"),y=d("font-awesome-icon"),f=d("openwb-base-avatar"),v=d("openwb-base-text-input"),P=d("openwb-io-device-proxy"),k=d("openwb-base-card"),x=d("openwb-base-select-input"),E=d("openwb-base-alert"),V=d("openwb-io-action-proxy"),q=d("openwb-base-submit-buttons");return n(),c(C,null,[s(p,{show:u.showIoDeviceDeleteModal,title:"Modul löschen",subtype:"danger",buttons:[{text:"Löschen",event:"confirm",subtype:"danger"}],onModalResult:e[0]||(e[0]=a=>o.removeIoDevice(u.modalIoDeviceIndex,a))},{default:i(()=>[r(' Willst Du das Ein-/Ausgangs-Gerät "'+b(o.getIoDeviceName(u.modalIoDeviceIndex))+'" (ID: '+b(u.modalIoDeviceIndex)+") wirklich entfernen? Dieser Vorgang kann nicht rückgängig gemacht werden! ",1)]),_:1},8,["show"]),s(p,{show:u.showIoActionDeleteModal,title:"Aktion löschen",subtype:"danger",buttons:[{text:"Löschen",event:"confirm",subtype:"danger"}],onModalResult:e[1]||(e[1]=a=>o.removeIoAction(u.modalIoActionIndex,a))},{default:i(()=>[r(' Willst Du die Aktion "'+b(o.getIoDeviceName(u.modalIoActionIndex))+'" (ID: '+b(u.modalIoActionIndex)+") wirklich entfernen? Dieser Vorgang kann nicht rückgängig gemacht werden! ",1)]),_:1},8,["show"]),_("div",de,[_("form",ue,[s(k,{title:"Ein-/Ausgangs-Geräte"},{default:i(()=>[(n(!0),c(C,null,B(o.installedIoDevices,(a,w)=>(n(),g(k,{key:w,title:a?.name+" (ID: "+a?.id+")",collapsible:!0,collapsed:!0,subtype:"primary"},{actions:i(m=>[m.collapsed?h("",!0):(n(),g(f,{key:0,class:"bg-danger clickable",onClick:O=>o.removeIoDeviceModal(w,O)},{default:i(()=>[s(y,{icon:["fas","trash"]})]),_:1},8,["onClick"]))]),default:i(()=>[s(v,{title:"Bezeichnung",subtype:"text","model-value":a.name,"onUpdate:modelValue":m=>t.updateState(w,m,"name")},null,8,["model-value","onUpdate:modelValue"]),s(v,{title:"Modul",subtype:"text",disabled:"",readonly:"","model-value":t.$store.state.mqtt[w].type},null,8,["model-value"]),e[8]||(e[8]=_("hr",null,null,-1)),s(P,{"io-device":a,"onUpdate:configuration":m=>o.updateConfiguration(w,m),onSendCommand:e[2]||(e[2]=m=>o.sendSystemCommand(m.command,m.data))},null,8,["io-device","onUpdate:configuration"])]),_:2},1032,["title"]))),128)),Object.keys(o.installedIoDevices).length>0?(n(),c("hr",ce)):h("",!0),s(x,{title:"Verfügbare Geräte","not-selected":"Bitte auswählen",options:o.ioDeviceList,"model-value":u.ioDeviceToAdd,"add-button":!0,"onUpdate:modelValue":e[3]||(e[3]=a=>u.ioDeviceToAdd=a),"onInput:add":o.addIoDevice},{help:i(()=>[...e[9]||(e[9]=[r(" Bitte ein Ein-/Ausgangs-Modul auswählen, das hinzugefügt werden soll. ",-1)])]),_:1},8,["options","model-value","onInput:add"])]),_:1}),s(k,{title:"Ein-/Ausgangs-Aktionen"},{default:i(()=>[t.$store.state.mqtt["openWB/general/extern"]===!0?(n(),g(E,{key:0,subtype:"info"},{default:i(()=>[...e[10]||(e[10]=[r(' Diese Einstellungen sind nicht verfügbar, solange sich diese openWB im Steuerungsmodus "secondary" befindet. ',-1)])]),_:1})):(n(),c("div",pe,[(n(!0),c(C,null,B(o.installedIoActions,(a,w)=>(n(),g(k,{key:w,title:a?.name+" (ID: "+a?.id+")",collapsible:!0,collapsed:!0,subtype:"primary"},{actions:i(m=>[m.collapsed?h("",!0):(n(),g(f,{key:0,class:"bg-danger clickable",onClick:O=>o.removeIoActionModal(w,O)},{default:i(()=>[s(y,{icon:["fas","trash"]})]),_:1},8,["onClick"]))]),default:i(()=>[s(v,{title:"Bezeichnung",subtype:"text","model-value":a?.name,"onUpdate:modelValue":m=>t.updateState(w,m,"name")},null,8,["model-value","onUpdate:modelValue"]),s(v,{title:"Modul",subtype:"text",disabled:"",readonly:"","model-value":[a?.group,a?.type].join(" / ")},null,8,["model-value"]),e[11]||(e[11]=_("hr",null,null,-1)),a!==void 0?(n(),g(V,{key:0,"io-action":a,"io-devices":o.installedIoDevices,"installed-charge-points":o.installedChargePoints,"installed-components":o.installedComponents,"onUpdate:configuration":m=>o.updateConfiguration(w,m)},null,8,["io-action","io-devices","installed-charge-points","installed-components","onUpdate:configuration"])):h("",!0)]),_:2},1032,["title"]))),128)),Object.keys(o.installedIoActions).length>0?(n(),c("hr",me)):h("",!0),Object.keys(o.installedIoDevices).length>0?(n(),g(x,{key:1,title:"Verfügbare Aktionen","not-selected":"Bitte auswählen",groups:o.ioActionList,"model-value":u.ioActionToAdd,"add-button":!0,"onUpdate:modelValue":e[4]||(e[4]=a=>u.ioActionToAdd=a),"onInput:add":o.addIoAction},{help:i(()=>[...e[12]||(e[12]=[r(" Bitte eine Ein-/Ausgangs-Aktion auswählen, die hinzugefügt werden soll. ",-1)])]),_:1},8,["groups","model-value","onInput:add"])):(n(),g(E,{key:2,subtype:"warning"},{default:i(()=>[...e[13]||(e[13]=[r(" Keine Ein-/Ausgangs-Geräte vorhanden!",-1),_("br",null,null,-1),r(" Bitte füge zuerst ein Ein-/Ausgangs-Gerät hinzu, bevor Du Aktionen konfigurierst. ",-1)])]),_:1}))]))]),_:1}),s(q,{"form-name":"ioConfigForm",onSave:e[5]||(e[5]=a=>t.$emit("save")),onReset:e[6]||(e[6]=a=>t.$emit("reset")),onDefaults:e[7]||(e[7]=a=>t.$emit("defaults"))})])])],64)}const be=I(le,[["render",ge],["__file","/opt/openWB-dev/openwb-ui-settings/src/views/IoConfig.vue"]]),we=Object.freeze(Object.defineProperty({__proto__:null,default:be},Symbol.toStringTag,{value:"Module"}));export{be as I,F as O,Z as a,we as b};
